# Pascal2C

## 任务初步安排

由于本组人数7人，属于是特别多，所以尽量将任务划分多一点，避免三四个人做同一块任务导致混乱。初步考虑分配如下几个任务

- 词法分析:将Pascal源码转化为token流，由语法分析程序调用词法分析器得到token。
- 语法分析:以词法分析器的输出作为输入，生成中间表达形式，建议中间表达形式为AST（抽象语法树）,因为该表示比较直观简单(大概吧)。
- 语义分析:以AST为输入，检查是否有类型错误，检查是否有当前作用域下使用了该作用域下没有的变量的错误，输出还是AST.
- 生成C代码:以上一步输出的AST为输入，输出C代码。

## 词法分析

该任务**一人**完成，需求：

1. 记录输入的文件名、当前token的行号、列号。
2. 设计好需要的token
   1. token的形式(建议是宏)
   2. token_value的形式:提供token对应的原始字符串，如解析到一个变量  var1，则提供"var1"，同时可以考虑解析出具体值，如整数123，直接提供123这一数值。可以使用union，具体如何设计交给接收该任务的成员。
3. 接口定义:在具体实现前先定义好接口，即先定义好token token_value，和函数、类、方法的原型，这部分要和做语法分析的成员交流达成共识，定义好接口后可以同时开工。接口有变化一定要及时说明。
4. 实现方法选择:手写或生成。
6. 考虑可能出现的词法错误。



接下该任务的先写一份词法分析器需求分析和设计和测试方法，不要求具体实现，但接口的雏形要有。

---

## 语法分析

该任务**两人**完成，需求

1. 写明pascal-S的语法。
2. 错误处理:碰到语法错误报错直接退出程序，或者继续解析最后输出碰到的全部语法错误。
3. 定义好AST的各个节点，该部分与做类型检查的成员要达成一致，一定要能完整的表达出源代码所有的信息。
4. 实现:手写或生成。



本来语义分析也可以在语法分析这完成，但小组成员较多，故语法分析部分只检查语法生成AST树，不做语义分析的工作。接下该任务的写一下需求分析和初步设计和测试方法，其中AST节点定义额外重要。

---

## 语义分析

**两人**完成，需求

1. 需要检查类型错误，如赋值时类型不匹配、传参时类型不匹配。

2. 检查变量是否在当前作用域内可用。
3. 需要设计符号表来完成上述工作。
4. 输出的AST形式设计:和语法分析输出采用同样的AST结构，或者略微有改变？该设计要和代码生成的成员商量并达成一致。
5. 错误处理方式:碰到第一个错误退出或检查完全部错误。



接下该任务的写需求分析、设计和测试方法，重要的是最后的输出AST定义，一定要能和代码生成的对接上。

---

## 代码生成

**两人**完成，需求

1. 对各类AST节点，如何生成C代码。



写需求分析、设计、测试方法。
