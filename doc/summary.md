# 课程设计总结

## 体会与收获

- 尹睿: 在这个项目中，我主要负责了词法分析和主程序的部分。通过这个过程，我学习并实践了很多编译原理的知识，对词法分析有了更深刻的认识。以下是我在这个项目中的一些体会与收获：

    首先，我深刻认识到了计算机科学中理论与实践相结合的重要性。在这个项目中，我们不仅需要理解和掌握编译原理的理论知识，还需要将这些理论知识应用到实践中去，设计和实现一个真正的编译器。这个过程不仅考验了我的理论知识，还考验了我的编程能力和解决问题的能力。例如在词法分析的实现中，我遇到了很多需要注意的细节。在处理注释时，需要注意注释的嵌套；在处理字符串时，需要注意字符串的转义字符；在处理数字时，需要注意数字的溢出等等。这些细节如果处理不好，都可能导致编译器的错误，这让我深刻理解了细节和实践的重要性。

    其次，在实现词法分析器的过程中，我发现错误处理是一个非常复杂的问题。如果一个token无法正常识别，直接报错是不合适的，因为一个错误可能导致后续的语法分析等部件无法正常工作。因此，我们采用结构化的错误处理方式，即生成一个错误token，并保存错误信息。这种方式的好处是可以让后续的模块继续工作，而不会因为错误而停止。在Flex中，我们使用错误恢复机制来处理错误。当发现一个错误时，Flex会跳过错误的字符，直到找到下一个合法的token。这种机制可以让词法分析器继续工作，并尽可能多地识别出合法的token。

    此外，在这个项目中，我和其他团队成员共同完成了Pascal2C编译器的实现。在这个过程中，我们需要相互合作，比如在定义token的类型时，我们需要和语法分析的团队成员进行沟通，确保我们定义的token类型和他们的需求相匹配。这个过程让我深刻理解了团队合作的重要性。

    总的来说，这个项目让我对编译原理有了更深入的理解，也让我学会了如何使用Flex这个强大的工具进行词法分析。在实践中，我明白了要注意许多细节，并学会了如何处理错误，以及怎么和团队成员协作完成项目。

- 陈宇：在本次编译原理课程设计中，我们的目标是实现 Pascal-s 语言到 C 语言的编译器。作为小组成员之一，我的任务是和谢卫凯同学共同完成 Pascal-S 程序的语法分析。我负责对 Pascal 程序中非复合语句部分（即程序，常量，变量和子程序的声明部分）进行语法分析和错误处理，最终生成该部分的抽象语法树（AST）。

    在实验过程中，我首先学习了 Pascal-s 语言的语法规则和语义规范，对 Pascal-s 语言的语法规则进行了深入的研究和理解。然后，采用自顶向下的递归下降分析法，编写代码将 Pascal-s 语言的源代码转换为对应的抽象语法树。我在实现语法分析器的过程中，非常注重代码的可读性和可维护性，采用了面向对象的编程思想，使得语法分析器的代码结构清晰，易于理解和修改。最后，我学习使用了 GoogleTest 测试框架，编写测试用例对语法分析器进行了测试和调试，确保其能够正确地将 Pascal-s 语言的源代码转换为对应的抽象语法树，并能够正确的识别出语法错误，做出相应的处理。

    通过本次编译原理课程设计，我不仅深入了解了编译原理的基本原理和方法，掌握了语法分析器的设计和实现技术，还锻炼了自己的编程能力和团队协作能力。我相信，在未来的学习和工作中，这些经验和技能将对我有很大的帮助和指导
    
- 谢卫凯：在编译原理课程设计中，我担任了组长的角色，负责组织、协调和安排组员的工作。我们的任务是实现一个编译系统，将pascal-s语言转换为c语言。在整个项目中，我积极参与了ast的设计工作，并负责实现了一部分语法分析器的功能。同时，我也对实现的功能进行了充分的测试，并参与了各模块的集成测试。

    这次课程设计让我受益匪浅。首先，我学习了pascal的语法和语义规则，深入了解了编译器的工作原理。其次，通过这个项目，我加强了c++编程能力和代码设计能力，掌握了更多的编程技巧和优化方法。此外，我还熟悉了递归下降的语法分析方法，掌握了一种常用的语法分析技术。最后，这次课程设计也锻炼了我的团队协作能力，让我更好地理解团队合作的重要性，以及如何更好地管理和组织团队。

    这次编译原理课程设计是一个充满挑战的项目。通过参与其中，我不仅学习了新的技术和知识，还锻炼了自己的能力和素质。相信这份经历会有所帮助。

- 韩雷：在本次编译原理课程设计中，我负责和王佳禾同学共同完成语义分析部分，我们共同设计了符号表的物理模型、我还负责了处理ast的逻辑设计与代码编写。通过完成课设工作，我加深了对Pascal语法的理解，特别是对重名、冲突等细节的理解；我学习了在windows平台下使用cmake工具，并学会了阅读和编写CMakeLists以此完成对代码的测试。本次课设提高了我的c++编程技巧，通过和他人合作完成代码、阅读他人的代码，学习他人代码编写技巧，提高了我的c++编程能力。
    
- 王佳禾：本次课设我们合作完成了一个pascal到c的编译器，我更加深刻的理解到了编译器的地位、作用、实现技术与具体实现时面临的挑战。通过完成这样一个中型项目，锻炼了我的编程能力和团队沟通协作能力。

- 吴清柳：

- 凌梓超：
    通过本次编译原理课程设计，深入了解了编译原理的基本原理和方法，对程序分析和编译技术领域有了一些基本的概念。感觉收获很多。
---

## 遇到的问题与解决方案

### 词法分析

1. 列号记录：在词法分析过程中，我们需要精确地跟踪每个token的位置，以便在语法分析和错误报告中使用。我发现Flex默认只提供了行号（yylineno）跟踪，没有列号跟踪。为了解决这个问题，我在YY_USER_ACTION宏中增加了列号跟踪代码。这个宏会在每次识别出一个token时执行，我在其中更新了列号计数器yycolno，并计算下一个token的起始列号yycolno_next。这种方法成功解决了列号记录问题。

2. 错误处理：在词法分析过程中，遇到无法识别的字符或序列时，我们需要进行错误处理。最初，我直接输出错误信息，但这会破坏token序列的完整性，导致后续的语法分析出现问题。为了解决这个问题，我引入了一个特殊的token ERROR，用于表示错误。当遇到错误时，词法分析器会输出ERROR token，并保存错误类型。这样，程序可以继续进行，而不会因为一个错误就中断，错误处理变得更为灵活和稳健。

3. 实数词法与dotdot词法冲突：在Pascal-S语言中，实数和区间（dotdot）符号 ".." 都包含点号，这可能导致词法冲突。例如，当词法分析器看到 "[3.." 时，它可能会错误地将 "3.." 解析为一个实数，而不是一个整数和一个区间符号。为了解决这个问题，我使用了Flex的"向前看"功能，使得实数后不能直接接"."。这样，当词法分析器看到一个点号后面紧跟着一个点号时，它会知道这是一个区间符号，而不是实数的一部分。

### 语法分析

1. 问题：由于 windows 上的 MinGW 不支持 c++ 的多线程标准库，在使用 GoogleTest 框架时会出现编译失败的问题。
   解决方案：选择使用 WSL 上的 Ubuntu 作为开发平台。
   
1. 问题：表达式解析时由于优先级较多、表达式因子复杂等原因，若按照产生式编写递归下降代码很繁琐，代码重复度高，修改不灵活。
   
   解决方案：参考pratt解析方法进行表达式解析，不需要针对每个优先级编写解析函数，代码简单易于修改。

### 语义分析

1. 问题：支持pascal语言将函数返回值当作变量使用。
   解决方案：将函数返回值的属性设置成既是一个变量又是一个函数，以区分返回值、变量和函数。
2. 问题：访问数组时，可以仅指定部分维度。
   解决方案：查询时，由于变量不存在重载问题，故可以以名字做索引。发现查询变量时，比较其带的参数列表信息，通过其带的参数列表长度进行判断，返回其对应的类型。

### 代码生成



## 对课程的建议

实践和理论结合：虽然本课程的理论部分讲解得很清楚，但我觉得可以增加更多实践的机会。例如，为每个主要的编译原理概念设计一个小的实践项目，这样学生可以在实践中更好地理解和记住这些概念。

错误处理的讲解：在我做项目的过程中，我发现错误处理是一个比较难的部分。我建议在课程中增加关于错误处理的讲解和示例，包括如何设计错误token，如何在词法分析和语法分析中处理错误等。

工具使用的指导：虽然Flex和Bison是非常强大的工具，但是对于初学者来说，学习使用它们可能有些困难。我建议课程可以提供一些详细的教程或者示例代码，帮助学生快速上手这些工具。

互动环节：课程可以增加一些互动环节，比如讨论区，让学生可以交流自己的想法和解决问题的方法。这不仅可以提高学生的学习兴趣，也可以帮助他们从不同的角度理解课程内容。

课后资料：提供一些进一步阅读的资料，包括相关的论文，文章或者书籍，可以帮助对某个主题有深入兴趣的学生进行更深入的学习。以上就是我对课程的一些建议，希望能对课程的改进有所帮助。